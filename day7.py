#-------------------------------------------------------------
# Advent of Code 2025
#-------------------------------------------------------------
import parse

testData = """\
.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
...............\
""".split('\n')

data = """\
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^...^....................................................................
.............................................................................................................................................
...................................................................^.^...^...................................................................
.............................................................................................................................................
..................................................................^.^...^.^..................................................................
.............................................................................................................................................
.................................................................^.^...^.^.^.................................................................
.............................................................................................................................................
................................................................^.^...^.^.^.^................................................................
.............................................................................................................................................
...............................................................^.......^.^.^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^...^.....^..............................................................
.............................................................................................................................................
.............................................................^.^.^.^.^.^.......^.............................................................
.............................................................................................................................................
............................................................^...^.^.^...^...^...^............................................................
.............................................................................................................................................
...........................................................^.^.^.....^.^.^.^.....^...........................................................
.............................................................................................................................................
..........................................................^.^.....^.^.^.^.^.^.....^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^.^...^.....^...^.^.........................................................
.............................................................................................................................................
........................................................^.^.^.^.....^...^.^.^.^.^...^........................................................
.............................................................................................................................................
.......................................................^.^.^...^.^.^.^.^.......^.^.^.^.......................................................
.............................................................................................................................................
......................................................^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.....^.^.^.^.^...^.^.......^...^.....................................................
.............................................................................................................................................
....................................................^.^...^.^.^...^...^.^.......^...^...^....................................................
.............................................................................................................................................
...................................................^...^...^.....^.^.^...^.^.^.^.^...^.^.^...................................................
.............................................................................................................................................
..................................................^.^.^.^.^.^.....^.^...^.....^...^.....^.^..................................................
.............................................................................................................................................
.................................................^.^.^.^.^...^.....^.^...^.^.....^...^.^...^.................................................
.............................................................................................................................................
................................................^...^.^.^.^.^.^.^...^.....^.^.^.^.^.^.^.^...^................................................
.............................................................................................................................................
...............................................^...^.^...^.^...^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^.....^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.^..............................................
.............................................................................................................................................
.............................................^.^.....^.^...^...^.^.......^.^.^.^.....^...^.^.^.^.............................................
.............................................................................................................................................
............................................^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.....^.^............................................
.............................................................................................................................................
...........................................^.^.^.^.^...^.......^.^...^.......^.^.^.^...^.^.....^.^...........................................
.............................................................................................................................................
..........................................^...^.^.^...^...^.^.^...^.^.^...........^.^.^.^...^.^.^.^..........................................
.............................................................................................................................................
.........................................^...^.^...^.^.^.^...^.^.^.^.^.^.^.^.^...^.^...^.^.^.^...^.^.........................................
.............................................................................................................................................
........................................^...^...^.^.^.^.^.^.......^.^.^.^.^.^.^.^.....^...^...^.^.^.^........................................
.............................................................................................................................................
.......................................^.^...^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^.^.^.......................................
.............................................................................................................................................
......................................^.^.....^.......^.^.^.^.^.^.^.^.....^.^.^.^.^.^.^.^.....^.^.....^......................................
.............................................................................................................................................
.....................................^...^.^...^...^.....^.^.^...^.^...^.^...^.^.....^.......^.^.^.^.^.^.....................................
.............................................................................................................................................
....................................^.......^...^.^...^.^.^.^.^...^...^.^.^...^.^...^.^.^.^.....^.^.^...^....................................
.............................................................................................................................................
...................................^.^.^.^...^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^...^...^.^...^.^...^.....^...................................
.............................................................................................................................................
..................................^.^.^.^.....^.....^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^...^.^...^.^.^.^..................................
.............................................................................................................................................
.................................^.^.^.^.....^...^.^.....^...^...^...^.^...^.^.....^.^.^.^.^...^.^.^.......^.................................
.............................................................................................................................................
................................^.^.^.^.^.^.^.^...^.^.^...^...^.^.^...^.^.^...^.^.....^.^.^.......^...^.^.^.^................................
.............................................................................................................................................
...............................^.^.^...^.^.....^.^...^.......^.^...^.^.^...^...^.^.^.^.^...^.^...^.^.^.......^...............................
.............................................................................................................................................
..............................^.^...^.^.^.^.^.......^...^.^.....^.^...^.^.^.^...^.^.^.^.^.^...^.^.^.^.^...^.^.^..............................
.............................................................................................................................................
.............................^...^.^.^.^.^.^...^.....^.....^.^.^.........^.^.^...^.^.^.^.^...^.^.^...^.^...^.^.^.............................
.............................................................................................................................................
............................^...^.^.....^.^.^.....^.......^...^...^...^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^............................
.............................................................................................................................................
...........................^.^.....^...^.^.^.^.^...^...^.....^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.....^...^...^.^.^...........................
.............................................................................................................................................
..........................^.^.^.^.^.^...^.^.^...^.^.^...^.....^.^.^.^.^.^.....^.^.....^.^.^...^.^.^.^...^.^.^.^...^..........................
.............................................................................................................................................
.........................^.^...^...^.^.^.....^.^.^...^.^.....^.^.^.^.^.^.^.^.....^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.........................
.............................................................................................................................................
........................^.^.......^.^...^...^.^.^...^.....^.^.^.^.^...^.^.^.^.^.^.^.^...^...^.....^...^.^...........^........................
.............................................................................................................................................
.......................^.^.^.......^.^.^.^...^.^.^.^...^.^.^...^.^.^.^...^.^.^.........^.^.^.^.^...^.^.^.^.^.......^.^.......................
.............................................................................................................................................
......................^.^.^.......^...^.^.^...^...^.^.^.......^.^...^.^.^.^.^.^.^.^...^.....^...^.^.^...^.....^.^.^.^.^......................
.............................................................................................................................................
.....................^.^...^...^.^...^.^.^.......^.......^.^.^.^...^...^...^.^...^.^.^.^.^.^.....^...^.^...^...^.^.....^.....................
.............................................................................................................................................
....................^...^.^.^.^...^...^.^.^...^.^.^.^.^.^...^.^...^...^.^.^.^.^.^.^.^.^...^...^.^...^...^.^.^.^.^.^.^...^....................
.............................................................................................................................................
...................^.^.^.^.^.^.^.....^.....^.^.^.^...^.^.^.^.^.^.^.^.^...^...^...^...^.^.^.^.^.^...^.^.^.^.....^.^.^.....^...................
.............................................................................................................................................
..................^.^.^.^...^.^.^...^.^.^.^.^.^...^.^...^.^.^.^.^...^.^.^.^...^.^.....^.^.^.^...^.^.^...^.....^.^.^.^.^.^.^..................
.............................................................................................................................................
.................^.^...^.^.^.^.^.^.^.....^.^.^...^.^.^.^.^.^.^...^.^.^.^.^...^.....^.....^.^.....^...^...^.^.^.^.^.^...^.^.^.................
.............................................................................................................................................
................^.^.^...^.^.^.^.^...^.^.^.^...^.....^.^.^.....^.^.^.^.^.^.^...^...^.^.^.^...^.^...^.^.^.^.^.^...^.^.^.^...^.^................
.............................................................................................................................................
...............^.^...^.^.^...^.^.^.^.^...^.^.^...^.^.^.^.....^...^.^.^.....^.........^.^.^...^...^...^.^.....^.^.^.^.^.^.^.^.^...............
.............................................................................................................................................
..............^...^.^.^...^.^.^...^.^.^.^...^...^.^.^...^.^.^.^.....^...^.....^.^.^.^.^.^.......^.^.....^.^.^.....^.^...^...^.^..............
.............................................................................................................................................
.............^.^.^.^.^.^.....^...^.^.^.....^...^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^.^...^...^.^...^...^...^.^.^...^...^...^.^.^.^.^.^.............
.............................................................................................................................................
............^.^.^.....^...^.^.^.^.....^.^...^.^...^.^.^.^.^.^.^...^.......^.^.^.........^.^...^...^.^.^...^.^.^.^.^.^...^...^.^.^............
.............................................................................................................................................
...........^.^.^...^.^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.^...^.^...^...^...^...^.^.^.^.....^.^.........^.^...^.^.^.^.^.^.^.^.^...........
.............................................................................................................................................
..........^...^.......^.^.......^...........^.^.^.......^.^.^.^.^.^...^.........^.^.^...^.^.^...^.^.^.....^.^.^.^.^.^.^...^.^...^.^..........
.............................................................................................................................................
.........^...^...^.^.^...^.^...^.^.....^.^...^.^.^.^.^.^.^.^...^.^.....^.^.^.....^.^.^.^.........^.^...^.^.^.^.........^.^.....^...^.........
.............................................................................................................................................
........^.^.^.^...^...^...^...^.^.....^.....^.^.^...^...^.^.^.^.^.......^.^...^.^.^.^.^.....^.^.......^...^.^.^.^...^...^...^.^...^.^........
.............................................................................................................................................
.......^.^...^.^...^...^.^...^.^.^...^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^...^...^.^.^.^.^.^.^.^.^...^.^.^.^...^.^.^...^.....^.^.^.^.......
.............................................................................................................................................
......^...^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^.....^...^...^.^.^.^.^.^...^.^.^.....^.^.^.....^.^.....^.^...^.^.^.^.^...^.....^......
.............................................................................................................................................
.....^.^.^.....^.^.....^.....^.^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^.^.^...^.^.....^.....^.^...^.....^.^.^.........^.^...^...^...^...^.^.....
.............................................................................................................................................
....^...^.^.^.^.^.^...^...^...^...^...^.^.^.^...^.^.^...^.^.^.^.^...^.^.^.^.^...^...^.^.^...^.....^.^.^.^.^.^...^.^.....^.^.^.^.^...^.^.^....
.............................................................................................................................................
...^.^.^.^...^.^.^.......^.^.^.^.^.^.^...^.^.^.^.....^.^.......^.^.....^.^...^.^.^.^.....^.^.^.^.......^.....^.......^.^...^.^...^.^...^.^...
.............................................................................................................................................
..^...^.^.^.^.^...^...^...^...^.^...^...^.^.........^.^.^...^...^.^.^.^.^.^.^.....^.^.^.^.^.^.....^.^...^.^...^.^...^...^...^...^.^.^...^.^..
.............................................................................................................................................
.^.^.^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.......^...^.^.^.....^...^...^.......^...^.^.^.^...^.....^.^...^.......^.^.^.^.^...^.
.............................................................................................................................................\
""".split('\n')
	
#-------------------------------------------------------------
def go(lines, part):

	allBeams = set()
	splits = 0

	def beam(r, c):
		nonlocal lines, allBeams, splits

		while True:
			if (r,c) in allBeams:
				return 0
			allBeams.add((r,c))

			if r >= len(lines):
				return 1
			if lines[r][c] == '^':
				splits += 1
				return beam(r, c - 1) + beam(r, c + 1)
			r += 1

	beam(0, lines[0].index('S'))
	result = splits

	print(result)
	return result

#-------------------------------------------------------------
assert(go(testData, 1) == 21)
assert(go(data, 1) >= 0)
